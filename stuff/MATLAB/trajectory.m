function [] = trajectory(varargin)
% a little cannon trajectory demo

    if nargin==1
        error('Need the other coordinate');
    elseif nargin>2
        error('Too many arguements');
    end

    figure;
    h_axes = axes('Units','pixels',...
        'Tag','axes',...
        'OuterPosition',[20 60 400 400],...
        'Position',[40 80 400 400],...
        'XLimMode','manual',...
        'YLimMode','manual',...
        'YLim',[0 1000],...
        'XLim',[0 1000],...
        'ButtonDownFcn',@BDCB);
    a_sldr = uicontrol('Style','slider',...
        'Tag','a_sldr',...
        'Position',[120 40 200 20],...
        'Max',90,...
        'Min',0,...
        'Callback',@update);
    a_title = uicontrol('style','text',...
        'Position',[20 40 100 20],...
        'String','Initial Angle');
    v_sldr = uicontrol('Style','slider',...
        'Tag','v_sldr',...
        'Position',[120 20 200 20],...
        'Max',100,...
        'Min',0,...
        'Callback',@update);
    v_title = uicontrol('style','text',...
        'Position',[20 20 100 20],...
        'String','Initial Velocity');
    a_txt = uicontrol('Style','text',...
        'Tag','a_txt',...
        'Position',[320 40 40 20],...
        'String','0');
    v_txt = uicontrol('Style','text',...
        'Tag','v_txt',...
        'Position',[320 20 40 20],...
        'String','0');
    
end

function [x,y] = make_traj(v_x0,v_y0,g)
    t_max = max(roots([.5*g v_y0 0]));
    t = linspace(0,t_max,1000);
    x = v_x0.*t;
    y = v_y0.*t+.5.*g.*t.^2;
end

function update(varargin)
    g=-9.81;
    h_axes = findobj('Tag','axes');
    a_sldr = findobj('Tag','a_sldr');
    v_sldr = findobj('Tag','v_sldr');
    a_txt = findobj('Tag','a_txt');
    v_txt = findobj('Tag','v_txt');
    v_x0 = get(v_sldr,'Value')*cos(deg2rad(get(a_sldr,'Value')));
    v_y0 = get(v_sldr,'Value')*sin(deg2rad(get(a_sldr,'Value')));
    set(a_txt,'String',num2str(get(a_sldr,'Value')));
    set(v_txt,'String',num2str(get(v_sldr,'Value')));
    [x,y]=make_traj(v_x0,v_y0,g);
    cla(h_axes);
    hold on;
    plot(x,y);
    hold off;
    axis([0 1000 0 1000]);
end

function BDCB(src,event)
    pos = get(src,'CurrentPoint');
    x_click = pos(1,1);y_click = pos(1,2);
    [result,opt,fig] = fopt(x_click,y_click);
end
        